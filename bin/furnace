#!/usr/bin/env ruby

require 'furnace'

load ARGV[0]

pipeline = Furnace::Transform::Pipeline.new(*[
  Furnace::Transform::Rubinius::ASTBuild.new,
  Furnace::Transform::Rubinius::ASTNormalize.new,

  Furnace::Transform::Generic::LabelNormalize.new,
  Furnace::Transform::Generic::CFGBuild.new,
  Furnace::Transform::Generic::CFGNormalize.new,
])

cfg, = pipeline.run(method(:main).executable)

puts cfg.to_graphviz